<!DOCTYPE html>
<html>

<head>
  <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
  <script type="text/javascript" charset="utf-8">
  
    const yAxis = new THREE.Vector3(0,1,0);
    var q = new THREE.Quaternion(); // create once and reuse
    q.setFromAxisAngle( yAxis, Math.PI/2 );// desired world rotation axis, 90 degrees in radians
    let x, y, z;
    x = y = z = 0;
    let rotateOnY = true;
    // turning functions
    function turnLeft(){
      x += 90;
      changePosition(x, y, z);
    }
    
    // function turnDown(){
      
    //   rotateAroundWorldAxis(Math.PI / 2);
    // }
    
    // change axis
    // function toggleVerticalAxis(){
    //   let button = document.querySelector('#toggle-axis a-text');
    //   rotateOnY = !rotateOnY;
    //   button.setAttribute('text', `value: Toggle Axis (${rotateOnY? 'y' : 'z' })`);
    // }
    
    // create animation to change position
    function changePosition(x, y, z){
      let animation = document.createElement('a-animation');
      animation.setAttribute("attribute","rotation");
      animation.setAttribute("dur", 3000);
      animation.setAttribute("repeat", "0");
      animation.setAttribute("to",`${z} ${x} ${y}`);
      document.getElementById('dino').appendChild(animation);
      // document.getElementById('position-text').setAttribute('text', `value: Position(x, y, z): ${x} ${y} ${z}`);
    }
    
    // function rotateAroundWorldAxis(radians) {
    //     // Look here!
    //     // This math needs help
        
    //     const originalEuler = new THREE.Euler(x, y, z);
    //     const originalQuaternion = new THREE.Quaternion();
    //     originalQuaternion.setFromEuler(originalEuler);
        
    //     var tarQ = originalQuaternion.premultiply(q); //object.quaternion.premultiply( q );
    //     console.log(tarQ);

    //     var euler = new THREE.Euler();
    //     euler.setFromQuaternion(tarQ);
    //     console.log(euler);
    //     let rot = { // rot not pos
    //       x: THREE.Math.radToDeg(euler._x),
    //       y: THREE.Math.radToDeg(euler._y),
    //       z: THREE.Math.radToDeg(euler._z)
    //     };
        
    //     console.log(rot);
    //     // update to neares 45
    //     for(let axis of Object.keys(rot)){
    //       rot[axis] = nearest45(rot[axis]);
    //     }
    //     // update global x, y, z;
    //     x = rot.x; y = rot.y; z = rot.z;
        
    //     console.log(rot);
    //     changePosition(rot.x, rot.y, rot.z);
    // }
    
    // function nearest45(angle){
    //   return Math.round(angle/45.0)*45;
    // }
  </script>
</head>

<body>
  <a-scene>
    <a-assets timeout="30000">
      <a-asset-item dynamic-body id="spinosaurus" src="Cyber.glb"  response-type="arraybuffer"  ></a-asset-item>
    </a-assets>
    <a-entity dynamic-body look-controls="enabled:false" id="dino" position="3 -0.9 -1" scale="0.5 0.5 0.5">
      <a-entity  dynamic-body position="-18 2.15 -20" rotation="0 55 0"
                gltf-model="#spinosaurus"
                animation-mixer
                shadow="cast: true; receive: false"
                raycaster="objects: .clickable" 
      cursor="rayOrigin: mouse"></a-entity>
    </a-entity>  
    <a-box dynamic-body id="box" color="#E45334" width="2" height="2" depth="2" position="0 0 -10"></a-box>
    <a-entity
      raycaster="objects: .clickable"
      cursor="rayOrigin: mouse"> 
    </a-entity>
    <a-plane class="clickable" color="grey" width="1" height="1" position="6 -5 -10"
      onclick="turnLeft()">
      <!-- <a-text
        color="#000000"
        text="value: Left"
        position="-0.2 0 0.2">
      </a-text> -->
    </a-plane>
    
    <!-- <a-plane class="clickable" color="grey" width="2" height="2" position="4 0 -10"
      onclick="turnRight()">
      <a-text
        color="#000000"
        text="value: Right"
        position="-0.3 0 0.3">
      </a-text>
    </a-plane>
    
    <a-plane class="clickable" color="grey" width="2" height="2" position="0 4 -10"
      onclick="turnDown()">
      <a-text
        color="#000000"
        text="value: Down"
        position="-0.3 0 0.3">
      </a-text>
    </a-plane>
    
    <a-plane id="toggle-axis" class="clickable" color="grey" width="2" height="2" position="0 -4 -10"
      onclick="toggleVerticalAxis()">
      <a-text
        color="#000000"
        text="value: Toggle Axis (y)"
        position="-0.6 0.2 0.3">
      </a-text>
    </a-plane> -->
    
    <a-text
      id="position-text"
      color="white"
      scale="2"
     
      position="-2 -2 -10">
    </a-text>
    <a-sky color="blue"></a-sky>
    <a-camera position="0 0 0" look-controls="enabled:false">
      <a-cursor></a-cursor>
    </a-camera>
  </a-scene>
</body>

</html>